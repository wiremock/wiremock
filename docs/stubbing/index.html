

<!doctype html>
<html lang="en" class="no-js">
  <head>
    

<meta charset="utf-8">



<!-- begin SEO -->









<title>Stubbing - WireMock</title>







<meta name="description" content="Returning stubbed HTTP responses to specific requests.">

<meta property="og:locale" content="en-US">
<meta property="og:site_name" content="WireMock">
<meta property="og:title" content="Stubbing">




  <meta property="og:description" content="Returning stubbed HTTP responses to specific requests.">





  

  





  <meta property="og:type" content="article">
  <meta property="article:published_time" content="2017-10-22T20:37:16+01:00">
  
    <link rel="next" href="/docs/verifying/" title="Verifying">
  
  
    <link rel="prev" href="/docs/stateful-behaviour/" title="Stateful Behaviour">
  





  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "Person",
      "name" : "Tom Akehurst",
      "url" : null,
      "sameAs" : null
    }
  </script>






<!-- end SEO -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="WireMock Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<link href="https://fonts.googleapis.com/css?family=Lato|Source+Code+Pro" rel="stylesheet">

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<meta http-equiv="cleartype" content="on">

<link rel="shortcut icon" type="image/x-icon" href="/images/favicon3.png">

    <!-- start custom head snippets -->

<!-- insert favicons. use http://realfavicongenerator.net/ -->

<!-- end custom head snippets -->
  </head>

  <body>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->
    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <button><div class="navicon"></div></button>
        <ul class="visible-links">
          <li class="masthead__menu-item masthead__menu-item--lg">
            <a href="/"><img src="/images/wiremock-concept-icon-01.png" style="width: 80px; height: 37px" /></a>
          </li>
          
            

            
            <li class="masthead__menu-item"><a href="/docs/" title="Docs">Docs</a></li>
            

          
            

            
            <li class="masthead__menu-item"><a href="/about/" title="About">About</a></li>
            

          
            

            
            <li class="masthead__menu-item"><a href="https://github.com/tomakehurst/wiremock" title="GitHub" target="_blank">GitHub</a></li>
            

          
            

            
            <li class="masthead__menu-item"><a href="https://groups.google.com/forum/#!forum/wiremock-user" title="Mailing List" target="_blank">Mailing List</a></li>
            

          
            

            
            <li class="masthead__menu-item"><a href="/external-resources/" title="External Resources">External Resources</a></li>
            

          
            

            
            <li class="masthead__menu-item"><a href="http://consulting.wiremock.org" title="Support & Consulting">Support & Consulting</a></li>
            

          
            

            
            <li class="masthead__menu-item"><a href="http://get.mocklab.io/?utm_source=wiremock.org&utm_medium=primary-nav&utm_campaign=mocklab" title="MockLab" target="_blank">MockLab</a></li>
            

          
        </ul>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    

<div id="main" role="main">
  


<div class="sidebar sticky">
  <nav class="nav__list">

    <ul>
      

      
      <li>
        <a href="/docs/getting-started/">

        Getting Started
      </a>
      
      <li>
        <a href="/docs/junit-rule/">

        The JUnit 4.x Rule
      </a>
      
      <li>
        <a href="/docs/java-usage/">

        Java (Non-JUnit) Usage
      </a>
      
      <li>
        <a href="/docs/configuration/">

        Configuration
      </a>
      
      <li>
        <a href="/docs/running-standalone/">

        Running as a Standalone Process
      </a>
      
      <li>
        <a href="/docs/stubbing/" class="nav__list-item--selected">
        

        Stubbing
      </a>
      
      <li>
        <a href="/docs/verifying/">

        Verifying
      </a>
      
      <li>
        <a href="/docs/request-matching/">

        Request Matching
      </a>
      
      <li>
        <a href="/docs/proxying/">

        Proxying
      </a>
      
      <li>
        <a href="/docs/record-playback/">

        Record and Playback (New)
      </a>
      
      <li>
        <a href="/docs/response-templating/">

        Response Templating
      </a>
      
      <li>
        <a href="/docs/record-playback-legacy/">

        Record and Playback (Legacy)
      </a>
      
      <li>
        <a href="/docs/simulating-faults/">

        Simulating Faults
      </a>
      
      <li>
        <a href="/docs/stateful-behaviour/">

        Stateful Behaviour
      </a>
      
      <li>
        <a href="/docs/https/">

        HTTPS
      </a>
      
      <li>
        <a href="/docs/extending-wiremock/">

        Extending WireMock
      </a>
      
      <li>
        <a href="/docs/android/">

        Android
      </a>
      
      <li>
        <a href="/docs/spring-boot/">

        Spring Boot
      </a>
      
      <li>
        <a href="/docs/api/">

        Admin API Reference
      </a>
      
    </ul>
  </nav>
</div>


  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="Stubbing">
    <meta itemprop="description" content="       If you want start stubbing quickly with zero code, try MockLab. It provides a hosted, 100% WireMock compatible mocking service with a friendly web UI.    Learn more">
    <meta itemprop="datePublished" content="October 22, 2017">
    

    <div class="page__inner-wrap">
      <header>
        <h1 class="page__title" itemprop="headline">Stubbing
</h1>
      </header>

      <section class="page__content" itemprop="text">
        <div class="mocklab-callout"> 
  <p class="mocklab-callout__text">
    If you want start stubbing quickly with zero code, try <strong>MockLab</strong>. It provides a hosted, 100% WireMock compatible mocking service with a friendly web UI.
  </p>
  <a href="http://get.mocklab.io/?utm_source=wiremock.org&amp;utm_medium=docs-callout&amp;utm_campaign=stubbing" title="Learn more" class="mocklab-callout__learn-more-button">Learn more</a>
</div>

<p>A core feature of WireMock is the ability to return canned HTTP
responses for requests matching criteria. These are described in detail in <a href="/docs/request-matching/">Request Matching</a>.</p>

<h2 id="basic-stubbing">Basic stubbing</h2>

<p>The following code will configure a response with a status of 200 to be
returned when the relative URL exactly matches <code class="highlighter-rouge">/some/thing</code> (including
query parameters). The body of the response will be “Hello world!” and a
<code class="highlighter-rouge">Content-Type</code> header will be sent with a value of <code class="highlighter-rouge">text-plain</code>.</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">exactUrlOnly</span><span class="p">(</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">stubFor</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="n">urlEqualTo</span><span class="o">(</span><span class="s">"/some/thing"</span><span class="o">))</span>
            <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">aResponse</span><span class="o">()</span>
                <span class="o">.</span><span class="na">withHeader</span><span class="o">(</span><span class="s">"Content-Type"</span><span class="o">,</span> <span class="s">"text/plain"</span><span class="o">)</span>
                <span class="o">.</span><span class="na">withBody</span><span class="o">(</span><span class="s">"Hello world!"</span><span class="o">)));</span>

    <span class="n">assertThat</span><span class="o">(</span><span class="n">testClient</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"/some/thing"</span><span class="o">).</span><span class="na">statusCode</span><span class="o">(),</span> <span class="n">is</span><span class="o">(</span><span class="mi">200</span><span class="o">));</span>
    <span class="n">assertThat</span><span class="o">(</span><span class="n">testClient</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"/some/thing/else"</span><span class="o">).</span><span class="na">statusCode</span><span class="o">(),</span> <span class="n">is</span><span class="o">(</span><span class="mi">404</span><span class="o">));</span>
<span class="o">}</span>
</code></pre>
</div>

<blockquote>
  <p><strong>note</strong></p>

  <p>If you’d prefer to use slightly more BDDish language in your tests you
can replace <code class="highlighter-rouge">stubFor</code> with <code class="highlighter-rouge">givenThat</code>.</p>
</blockquote>

<p>To create the stub described above via the JSON API, the following
document can either be posted to
<code class="highlighter-rouge">http://&lt;host&gt;:&lt;port&gt;/__admin/mappings</code> or placed in a file with a
<code class="highlighter-rouge">.json</code> extension under the <code class="highlighter-rouge">mappings</code> directory:</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"request"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GET"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/some/thing"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span><span class="w">
        </span><span class="nt">"body"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Hello world!"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"headers"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"Content-Type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"text/plain"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<h3 id="java-shortcuts">Java Shortcuts</h3>

<p>Some common request and response patterns can be expressed in Java in abbreviated forms.</p>

<p>Requests matching an exact URL plus one of the most common HTTP methods (GET, POST, PUT, DELETE) can be stubbed like this:</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="n">stubFor</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="s">"/some/thing"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">aResponse</span><span class="o">().</span><span class="na">withStatus</span><span class="o">(</span><span class="mi">200</span><span class="o">)));</span>
</code></pre>
</div>

<p>Common responses can also be abbreviated e.g.:</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="n">stubFor</span><span class="o">(</span><span class="n">delete</span><span class="o">(</span><span class="s">"/fine"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">ok</span><span class="o">()));</span>

<span class="n">stubFor</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="s">"/fine-with-body"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">ok</span><span class="o">(</span><span class="s">"body content"</span><span class="o">)));</span>

<span class="n">stubFor</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="s">"/json"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">okJson</span><span class="o">(</span><span class="s">"{ \"message\": \"Hello\" }"</span><span class="o">)));</span>

<span class="n">stubFor</span><span class="o">(</span><span class="n">post</span><span class="o">(</span><span class="s">"/redirect"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">temporaryRedirect</span><span class="o">(</span><span class="s">"/new/place"</span><span class="o">)));</span>

<span class="n">stubFor</span><span class="o">(</span><span class="n">post</span><span class="o">(</span><span class="s">"/sorry-no"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">unauthorized</span><span class="o">()));</span>

<span class="n">stubFor</span><span class="o">(</span><span class="n">put</span><span class="o">(</span><span class="s">"/status-only"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">status</span><span class="o">(</span><span class="mi">418</span><span class="o">)));</span>

</code></pre>
</div>

<p>More DSL examples <a href="https://github.com/tomakehurst/wiremock/tree/master/src/test/java/ignored/Examples.java#374">can be found here</a>.</p>

<p>HTTP methods currently supported are:
<code class="highlighter-rouge">GET, POST, PUT, DELETE, HEAD, TRACE, OPTIONS</code>. You can specify <code class="highlighter-rouge">ANY</code> if
you want the stub mapping to match on any request method.</p>

<h3 id="setting-the-response-status-message">Setting the response status message</h3>

<p>In addition to the status code, the status message can optionally also
be set.</p>

<p>Java:</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">statusMessage</span><span class="p">(</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">stubFor</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="n">urlEqualTo</span><span class="o">(</span><span class="s">"/some/thing"</span><span class="o">))</span>
            <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">aResponse</span><span class="o">()</span>
                <span class="o">.</span><span class="na">withStatus</span><span class="o">(</span><span class="mi">200</span><span class="o">)</span>
                <span class="o">.</span><span class="na">withStatusMessage</span><span class="o">(</span><span class="s">"Everything was just fine!"</span><span class="o">)</span>
                <span class="o">.</span><span class="na">withHeader</span><span class="o">(</span><span class="s">"Content-Type"</span><span class="o">,</span> <span class="s">"text/plain"</span><span class="o">)));</span>

    <span class="n">assertThat</span><span class="o">(</span><span class="n">testClient</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"/some/thing"</span><span class="o">).</span><span class="na">statusCode</span><span class="o">(),</span> <span class="n">is</span><span class="o">(</span><span class="mi">200</span><span class="o">));</span>
    <span class="n">assertThat</span><span class="o">(</span><span class="n">testClient</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"/some/thing/else"</span><span class="o">).</span><span class="na">statusCode</span><span class="o">(),</span> <span class="n">is</span><span class="o">(</span><span class="mi">404</span><span class="o">));</span>
<span class="o">}</span>
</code></pre>
</div>

<p>JSON:</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"request"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GET"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/some/thing"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span><span class="w">
        </span><span class="nt">"statusMessage"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Everything was just fine!"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<h2 id="stub-priority">Stub priority</h2>

<p>It is sometimes the case that you’ll want to declare two or more stub
mappings that “overlap”, in that a given request would be a match for
more than one of them. By default, WireMock will use the most recently
added matching stub to satisfy the request. However, in some cases it is
useful to exert more control.</p>

<p>One example of this might be where you want to define a catch-all stub
for any URL that doesn’t match any more specific cases. Adding a
priority to a stub mapping facilitates this:</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="c1">//Catch-all case</span>
<span class="n">stubFor</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="n">urlMatching</span><span class="o">(</span><span class="s">"/api/.*"</span><span class="o">)).</span><span class="na">atPriority</span><span class="o">(</span><span class="mi">5</span><span class="o">)</span>
    <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">aResponse</span><span class="o">().</span><span class="na">withStatus</span><span class="o">(</span><span class="mi">401</span><span class="o">)));</span>

<span class="c1">//Specific case</span>
<span class="n">stubFor</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="n">urlEqualTo</span><span class="o">(</span><span class="s">"/api/specific-resource"</span><span class="o">)).</span><span class="na">atPriority</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="c1">//1 is highest</span>
    <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">aResponse</span><span class="o">()</span>
            <span class="o">.</span><span class="na">withStatus</span><span class="o">(</span><span class="mi">200</span><span class="o">)</span>
            <span class="o">.</span><span class="na">withBody</span><span class="o">(</span><span class="s">"Resource state"</span><span class="o">)));</span>
</code></pre>
</div>

<p>Priority is set via the <code class="highlighter-rouge">priority</code> attribute in JSON:</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"priority"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"request"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GET"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/api/specific-resource"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<h2 id="sending-response-headers">Sending response headers</h2>

<p>In addition to matching on request headers, it’s also possible to send response headers:</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="n">stubFor</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="n">urlEqualTo</span><span class="o">(</span><span class="s">"/whatever"</span><span class="o">))</span>
        <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">aResponse</span><span class="o">()</span>
                <span class="o">.</span><span class="na">withStatus</span><span class="o">(</span><span class="mi">200</span><span class="o">)</span>
                <span class="o">.</span><span class="na">withHeader</span><span class="o">(</span><span class="s">"Content-Type"</span><span class="o">,</span> <span class="s">"application/json"</span><span class="o">)</span>
                <span class="o">.</span><span class="na">withHeader</span><span class="o">(</span><span class="s">"Cache-Control"</span><span class="o">,</span> <span class="s">"no-cache"</span><span class="o">)));</span>
</code></pre>
</div>

<p>Or</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"request"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GET"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/whatever"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span><span class="w">
        </span><span class="nt">"headers"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nt">"Content-Type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"text/plain"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"Cache-Control"</span><span class="p">:</span><span class="w"> </span><span class="s2">"no-cache"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<h2 id="specifying-the-response-body">Specifying the response body</h2>

<p>The simplest way to specify a response body is as a string literal.</p>

<p>Java:</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="n">stubFor</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="n">urlEqualTo</span><span class="o">(</span><span class="s">"/body"</span><span class="o">))</span>
        <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">aResponse</span><span class="o">()</span>
                <span class="o">.</span><span class="na">withBody</span><span class="o">(</span><span class="s">"Literal text to put in the body"</span><span class="o">)));</span>
</code></pre>
</div>

<p>JSON:</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"request"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GET"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/body"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span><span class="w">
        </span><span class="nt">"body"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Literal text to put in the body"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p>If you’re specifying a JSON body via the JSON API, you can avoid having to escape it like this:</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="w">    </span><span class="s2">"response"</span><span class="err">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span><span class="w">
        </span><span class="nt">"jsonBody"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"arbitrary_json"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">]</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p>To read the body content from a file, place the file under the <code class="highlighter-rouge">__files</code>
directory. By default this is expected to be under <code class="highlighter-rouge">src/test/resources</code>
when running from the JUnit rule. When running standalone it will be
under the current directory in which the server was started. To make
your stub use the file, simply call <code class="highlighter-rouge">bodyFile()</code> on the response builder
with the file’s path relative to <code class="highlighter-rouge">__files</code>:</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="n">stubFor</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="n">urlEqualTo</span><span class="o">(</span><span class="s">"/body-file"</span><span class="o">))</span>
        <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">aResponse</span><span class="o">()</span>
                <span class="o">.</span><span class="na">withBodyFile</span><span class="o">(</span><span class="s">"path/to/myfile.xml"</span><span class="o">)));</span>
</code></pre>
</div>

<p>Or</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"request"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GET"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/body-file"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span><span class="w">
        </span><span class="nt">"bodyFileName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"path/to/myfile.xml"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<blockquote>
  <p><strong>note</strong></p>

  <p>All strings used by WireMock, including the contents of body files are
expected to be in <code class="highlighter-rouge">UTF-8</code> format. Passing strings in other character
sets, whether by JVM configuration or body file encoding will most
likely produce strange behaviour.</p>
</blockquote>

<p>A response body in binary format can be specified as a <code class="highlighter-rouge">byte[]</code> via an
overloaded <code class="highlighter-rouge">body()</code>:</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="n">stubFor</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="n">urlEqualTo</span><span class="o">(</span><span class="s">"/binary-body"</span><span class="o">))</span>
        <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">aResponse</span><span class="o">()</span>
                <span class="o">.</span><span class="na">withBody</span><span class="o">(</span><span class="k">new</span> <span class="kt">byte</span><span class="o">[]</span> <span class="o">{</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span> <span class="o">})));</span>
</code></pre>
</div>

<p>The JSON API accepts this as a base64 string (to avoid stupidly long
JSON documents):</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"request"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GET"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/binary-body"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span><span class="w">
        </span><span class="nt">"base64Body"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"WUVTIElOREVFRCE="</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<h2 id="default-response-for-unmapped-requests">Default response for unmapped requests</h2>

<p>When a request cannot be mapped to a response, Wiremock returns an HTML response with a 404 status code.</p>

<p>It is possible to customize the response by catching all URLs with a low priority.</p>

<p>In Java</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="n">stubFor</span><span class="o">(</span><span class="n">any</span><span class="o">(</span><span class="n">anyUrl</span><span class="o">())</span>
                <span class="o">.</span><span class="na">atPriority</span><span class="o">(</span><span class="mi">10</span><span class="o">)</span>
                <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">aResponse</span><span class="o">()</span>
                        <span class="o">.</span><span class="na">withStatus</span><span class="o">(</span><span class="mi">404</span><span class="o">)</span>
                        <span class="o">.</span><span class="na">withBody</span><span class="o">(</span><span class="s">"{\"status\":\"Error\",\"message\":\"Endpoint not found\"}"</span><span class="o">)));</span>
</code></pre>
</div>

<p>In JSON</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"priority"</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span><span class="w">
  </span><span class="nt">"request"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ANY"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"urlPattern"</span><span class="p">:</span><span class="w"> </span><span class="s2">".*"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">404</span><span class="p">,</span><span class="w">
    </span><span class="nt">"jsonBody"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">"status"</span><span class="p">:</span><span class="s2">"Error"</span><span class="p">,</span><span class="nt">"message"</span><span class="p">:</span><span class="s2">"Endpoint not found"</span><span class="p">},</span><span class="w">
    </span><span class="nt">"headers"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"Content-Type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"application/json"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<h2 id="saving-stubs">Saving stubs</h2>

<p>Stub mappings which have been created can be persisted to the <code class="highlighter-rouge">mappings</code>
directory via a call to <code class="highlighter-rouge">WireMock.saveAllMappings</code> in Java or posting a
request with an empty body to
<code class="highlighter-rouge">http://&lt;host&gt;:&lt;port&gt;/__admin/mappings/save</code>.</p>

<blockquote>
  <p><strong>note</strong>
Note that this feature is not available when running WireMock from a servlet container.</p>
</blockquote>

<h2 id="editing-stubs">Editing stubs</h2>

<p>Existing stub mappings can be modified, provided they have been assigned an ID.</p>

<p>In Java:</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="n">wireMockServer</span><span class="o">.</span><span class="na">stubFor</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="n">urlEqualTo</span><span class="o">(</span><span class="s">"/edit-this"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">withId</span><span class="o">(</span><span class="n">id</span><span class="o">)</span>
    <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">aResponse</span><span class="o">()</span>
        <span class="o">.</span><span class="na">withBody</span><span class="o">(</span><span class="s">"Original"</span><span class="o">)));</span>

<span class="n">assertThat</span><span class="o">(</span><span class="n">testClient</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"/edit-this"</span><span class="o">).</span><span class="na">content</span><span class="o">(),</span> <span class="n">is</span><span class="o">(</span><span class="s">"Original"</span><span class="o">));</span>

<span class="n">wireMockServer</span><span class="o">.</span><span class="na">editStub</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="n">urlEqualTo</span><span class="o">(</span><span class="s">"/edit-this"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">withId</span><span class="o">(</span><span class="n">id</span><span class="o">)</span>
    <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">aResponse</span><span class="o">()</span>
        <span class="o">.</span><span class="na">withBody</span><span class="o">(</span><span class="s">"Modified"</span><span class="o">)));</span>

<span class="n">assertThat</span><span class="o">(</span><span class="n">testClient</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"/edit-this"</span><span class="o">).</span><span class="na">content</span><span class="o">(),</span> <span class="n">is</span><span class="o">(</span><span class="s">"Modified"</span><span class="o">));</span>
</code></pre>
</div>

<p>To do the equivalent via the JSON API, <code class="highlighter-rouge">PUT</code> the edited stub mapping to <code class="highlighter-rouge">/__admin/mappings/{id}</code>:</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"request"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"urlPath"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"/edit-me"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"method"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"ANY"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"response"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"status"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<h2 id="file-serving">File serving</h2>
<p>When running the standalone JAR, files placed under the <code class="highlighter-rouge">__files</code> directory will
be served up as if from under the docroot, except if stub mapping
matching the URL exists. For example if a file exists
<code class="highlighter-rouge">__files/things/myfile.html</code> and no stub mapping will match
<code class="highlighter-rouge">/things/myfile.html</code> then hitting
<code class="highlighter-rouge">http://&lt;host&gt;:&lt;port&gt;/things/myfile.html</code> will serve the file.</p>

<p>This feature is also available with the standard JAR. To use it, define the filesRoot using <code class="highlighter-rouge">options.withRootDirectory()</code>, i.e. <code class="highlighter-rouge">options.withRootDirectory(getClass.getResource("/wiremock").getPath)</code></p>

<h2 id="removing-stubs">Removing stubs</h2>

<p>Stub mappings can be deleted via the Java API as follows:</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="n">StubMapping</span> <span class="n">stubMapping</span> <span class="o">=</span> <span class="n">stubFor</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="n">urlEqualTo</span><span class="o">(</span><span class="s">"/delete-me"</span><span class="o">))</span>
  <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">aResponse</span><span class="o">().</span><span class="na">withStatus</span><span class="o">(</span><span class="mi">200</span><span class="o">)));</span>

<span class="c1">// Do things with the stub</span>

<span class="n">removeStub</span><span class="o">(</span><span class="n">stubMapping</span><span class="o">);</span>
</code></pre>
</div>

<p>They can be deleted via the HTTP API by issuing a <code class="highlighter-rouge">DELETE</code> to <code class="highlighter-rouge">http://&lt;host&gt;:&lt;port&gt;/__admin/mappings/{id}</code>
where <code class="highlighter-rouge">id</code> is the UUID of the stub mapping, found in its <code class="highlighter-rouge">id</code> field.</p>

<h2 id="reset">Reset</h2>

<p>The WireMock server can be reset at any time, removing all stub mappings
and deleting the request log. If you’re using either of the JUnit rules
this will happen automatically at the start of every test case. However
you can do it yourself via a call to <code class="highlighter-rouge">WireMock.reset()</code> in Java or
sending a <code class="highlighter-rouge">POST</code> request with an empty body to
<code class="highlighter-rouge">http://&lt;host&gt;:&lt;port&gt;/__admin/reset</code>.</p>

<p>To reset just the stub mappings leaving the request log intact send a <code class="highlighter-rouge">DELETE</code> to <code class="highlighter-rouge">http://&lt;host&gt;:&lt;port&gt;/__admin/mappings</code>.</p>

<p>If you’ve created some file based stub mappings to be loaded at startup
and you don’t want these to disappear when you do a reset you can call
<code class="highlighter-rouge">WireMock.resetToDefault()</code> instead, or post an empty request to
<code class="highlighter-rouge">http://&lt;host&gt;:&lt;port&gt;/__admin/mappings/reset</code>.</p>

<h2 id="getting-all-currently-registered-stub-mappings">Getting all currently registered stub mappings</h2>

<p>All stub mappings can be fetched in Java by calling <code class="highlighter-rouge">WireMock.listAllStubMappings()</code>.</p>

<p>To fetch them via the HTTP API send a <code class="highlighter-rouge">GET</code> to <code class="highlighter-rouge">http://&lt;host&gt;:&lt;port&gt;/__admin/mappings</code>.</p>

<p>Optionally limit and offset parameters can be specified to constrain the set returned e.g.
<code class="highlighter-rouge">GET http://localhost:8080/__admin/mappings?limit=10&amp;offset=50</code></p>

<h2 id="getting-a-single-stub-mapping-by-id">Getting a single stub mapping by ID</h2>

<p>A single stub mapping can be retrieved by ID in Java by calling <code class="highlighter-rouge">WireMock.getSingleStubMapping(id)</code> where <code class="highlighter-rouge">id</code> is the
UUID of the stub mapping.</p>

<p>Via the HTTP client a mapping can be retrieved by sending a <code class="highlighter-rouge">GET</code> to <code class="highlighter-rouge">http://&lt;host&gt;:&lt;port&gt;/__admin/mappings/{id}</code>.</p>

        
      </section>

      <footer class="page__meta">
        
        




      </footer>

      
    </div>

    
  </article>

  
  
</div>


    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        

<div class="page__footer-follow">
  <ul class="social-icons">
    
    <li><strong>Follow:</strong></li>
    
    
    
    
    
    <li><a href="/feed.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2017 Tom Akehurst. Powered by <a href="http://jekyllrb.com"
                                                                                                                                                                  rel="nofollow">Jekyll</a> &amp; <a
  href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.
</div>

<div id="dialog" style="display: none">
  <h2 class="mocklab-popup__title">Looking for super-quick hosted mocks? Try MockLab</h2>
  <p>Instant mock services on your own public URL, zero code required. Paste, record and generate mock data. Tester-friendly UI.</p>
</div>

<script type="text/javascript">
  function setNotificationSeenCookie() {
    var expiresDate = new Date();
    expiresDate.setTime(expiresDate.getTime() + (30 * 86400000));
    document.cookie = "mocklab_notification_seen=true;expires=" + expiresDate.toGMTString() + ";path=/";
  }

  window.onload = function () {
    $("a[title='MockLab']").click(function() {
      _gaq.push(['_trackEvent', 'primary_nav', 'mocklab_clicked', 'MockLab clicked', 1]);
    });

    $("a[title='Consulting Services']").click(function() {
      _gaq.push(['_trackEvent', 'primary_nav', 'consulting_services_clicked', 'Consulting Services clicked', 1]);
    });

    if (!document.cookie.includes('mocklab_notification_seen')) {
      window.setTimeout(function () {
        $("#dialog").dialog({
          dialogClass: 'mocklab-popup',
          draggable: false,
          resizable: false,
          modal: true,
          show: {
            effect: 'fade',
            duration: 1000
          },
          buttons: [{
            class: 'mocklab-popup__confirm-button',
            text: "Learn More",
            click: function () {
              _gaq.push(['_trackEvent', 'mocklab_popup', 'learn_more_clicked', 'Learn More clicked', 1]);
              window.location.href = "http://get.mocklab.io/?utm_source=wiremock.org&utm_medium=mocklab-popup&utm_campaign=mocklab"
            }
          }]
        });

        setNotificationSeenCookie();
        _gaq.push(['_trackEvent', 'mocklab_popup', 'mocklab_popup_seen', 'MockLab popup seen', 0]);
      }, 500);

    }
  };
</script>

      </footer>
    </div>

    <script src="/assets/js/main.min.js"></script>




  <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-36386229-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>






  </body>
</html>

