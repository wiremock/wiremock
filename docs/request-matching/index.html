

<!doctype html>
<html lang="en" class="no-js">
  <head>
    

<meta charset="utf-8">



<!-- begin SEO -->









<title>Request Matching - WireMock</title>







<meta name="description" content="Matching and filtering HTTP requests in WireMock.">

<meta property="og:locale" content="en-US">
<meta property="og:site_name" content="WireMock">
<meta property="og:title" content="Request Matching">




  <meta property="og:description" content="Matching and filtering HTTP requests in WireMock.">





  

  





  <meta property="og:type" content="article">
  <meta property="article:published_time" content="2022-01-18T14:10:27+00:00">
  
    <link rel="next" href="/docs/response-templating/" title="Response Templating">
  
  
    <link rel="prev" href="/docs/record-playback/" title="Record and Playback (New)">
  





  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "Person",
      "name" : "Tom Akehurst",
      "url" : null,
      "sameAs" : null
    }
  </script>






<!-- end SEO -->





  <!-- Google Analytics -->
<style>.async-hide { opacity: 0 !important} </style>
<!--<script>(function(a,s,y,n,c,h,i,d,e){s.className+=' '+y;h.start=1*new Date;-->
  <!--h.end=i=function(){s.className=s.className.replace(RegExp(' ?'+y),'')};-->
  <!--(a[n]=a[n]||[]).hide=h;setTimeout(function(){i();h.end=null},c);h.timeout=c;-->
<!--})(window,document.documentElement,'async-hide','dataLayer',4000,-->
  <!--{'GTM-WQTGSSM':true});</script>-->

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-36386229-2', 'auto');
  ga('require', 'GTM-WQTGSSM');
  ga('send', 'pageview');
</script>
<!-- End Google Analytics -->




<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="WireMock Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<link href="https://fonts.googleapis.com/css?family=Lato|Source+Code+Pro|Cairo" rel="stylesheet">

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<meta http-equiv="cleartype" content="on">

<link rel="shortcut icon" type="image/x-icon" href="/images/favicon3.png">

    <!-- start custom head snippets -->

<!-- insert favicons. use http://realfavicongenerator.net/ -->

<!-- end custom head snippets -->
  </head>

  <body>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->
    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <button><div class="navicon"></div></button>
        <ul class="visible-links">
          <li class="masthead__menu-item masthead__menu-item--lg">
            <a href="/"><img src="/images/wiremock-concept-icon-01.png" style="width: 80px; height: 37px" /></a>
          </li>
          
            

            
            <li class="masthead__menu-item"><a href="/docs/" title="Docs">Docs</a></li>
            

          
            

            
            <li class="masthead__menu-item"><a href="/about/" title="About">About</a></li>
            

          
            

            
            <li class="masthead__menu-item"><a href="https://github.com/tomakehurst/wiremock" title="GitHub" target="_blank">GitHub</a></li>
            

          
            

            
            <li class="masthead__menu-item"><a href="https://groups.google.com/forum/#!forum/wiremock-user" title="Mailing List" target="_blank">Mailing List</a></li>
            

          
            

            
            <li class="masthead__menu-item"><a href="/external-resources/" title="External Resources">External Resources</a></li>
            

          

          <li class="masthead__menu-item">
            <a href="http://get.mocklab.io/?utm_source=wiremock.org&utm_medium=primary-nav&utm_campaign=mocklab" title="MockLab" target="_blank">
              <img src="/images/mocklab_logo_transparent.png" style="height: 23px; width: auto; margin-right: 5px; vertical-align: top;" />
              MockLab
            </a>
          </li>
        </ul>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    

<div id="main" role="main">
  


<div class="sidebar sticky">
  <nav class="nav__list">

    <ul>
      

      
      <li>
        <a href="/docs/getting-started/">

        Getting Started
      </a>
      
      <li>
        <a href="/docs/download-and-installation/">

        Download and Installation
      </a>
      
      <li>
        <a href="/docs/junit-extensions/">

        JUnit 4 and Vintage Usage
      </a>
      
      <li>
        <a href="/docs/junit-jupiter/">

        JUnit 5+ Jupiter Usage
      </a>
      
      <li>
        <a href="/docs/java-usage/">

        Java (Non-JUnit) Usage
      </a>
      
      <li>
        <a href="/docs/configuration/">

        Configuration
      </a>
      
      <li>
        <a href="/docs/running-standalone/">

        Running as a Standalone Process
      </a>
      
      <li>
        <a href="/docs/running-without-http-server/">

        Running without the HTTP Server
      </a>
      
      <li>
        <a href="/docs/docker/">

        Running in Docker
      </a>
      
      <li>
        <a href="/docs/stubbing/">

        Stubbing
      </a>
      
      <li>
        <a href="/docs/verifying/">

        Verifying
      </a>
      
      <li>
        <a href="/docs/request-matching/" class="nav__list-item--selected">
        

        Request Matching
      </a>
      
      <li>
        <a href="/docs/proxying/">

        Proxying
      </a>
      
      <li>
        <a href="/docs/multi-domain-mocking/">

        Multi-domain Mocking
      </a>
      
      <li>
        <a href="/docs/record-playback/">

        Record and Playback (New)
      </a>
      
      <li>
        <a href="/docs/record-playback-legacy/">

        Record and Playback (Legacy)
      </a>
      
      <li>
        <a href="/docs/response-templating/">

        Response Templating
      </a>
      
      <li>
        <a href="/docs/simulating-faults/">

        Simulating Faults
      </a>
      
      <li>
        <a href="/docs/stateful-behaviour/">

        Stateful Behaviour
      </a>
      
      <li>
        <a href="/docs/https/">

        HTTPS
      </a>
      
      <li>
        <a href="/docs/webhooks-and-callbacks/">

        Webhooks and Callbacks
      </a>
      
      <li>
        <a href="/docs/extending-wiremock/">

        Extending WireMock
      </a>
      
      <li>
        <a href="/docs/android/">

        Android
      </a>
      
      <li>
        <a href="/docs/spring-boot/">

        Spring Boot
      </a>
      
      <li>
        <a href="/docs/stub-metadata/">

        Stub Metadata
      </a>
      
      <li>
        <a href="/docs/api/">

        Admin API Reference
      </a>
      
    </ul>
  </nav>
</div>


  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="Request Matching">
    <meta itemprop="description" content="WireMock supports matching of requests to stubs and verification queries using the following attributes:">
    <meta itemprop="datePublished" content="January 18, 2022">
    

    <div class="page__inner-wrap">
      <header>
        <h1 class="page__title" itemprop="headline">Request Matching
</h1>
      </header>

      <section class="page__content" itemprop="text">
        <p>WireMock supports matching of requests to stubs and verification queries using the following attributes:</p>

<ul>
  <li>URL</li>
  <li>HTTP Method</li>
  <li>Query parameters</li>
  <li>Headers</li>
  <li>Basic authentication (a special case of header matching)</li>
  <li>Cookies</li>
  <li>Request body</li>
  <li>Multipart/form-data</li>
</ul>

<p>Here’s an example showing all attributes being matched using WireMock’s in-built match operators. It is also possible to write <a href="/docs/extending-wiremock/#custom-request-matchers">custom matching logic</a> if
you need more precise control:</p>

<p>Java:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">stubFor</span><span class="o">(</span><span class="n">any</span><span class="o">(</span><span class="n">urlPathEqualTo</span><span class="o">(</span><span class="s">"/everything"</span><span class="o">))</span>
  <span class="o">.</span><span class="na">withHeader</span><span class="o">(</span><span class="s">"Accept"</span><span class="o">,</span> <span class="n">containing</span><span class="o">(</span><span class="s">"xml"</span><span class="o">))</span>
  <span class="o">.</span><span class="na">withCookie</span><span class="o">(</span><span class="s">"session"</span><span class="o">,</span> <span class="n">matching</span><span class="o">(</span><span class="s">".*12345.*"</span><span class="o">))</span>
  <span class="o">.</span><span class="na">withQueryParam</span><span class="o">(</span><span class="s">"search_term"</span><span class="o">,</span> <span class="n">equalTo</span><span class="o">(</span><span class="s">"WireMock"</span><span class="o">))</span>
  <span class="o">.</span><span class="na">withBasicAuth</span><span class="o">(</span><span class="s">"jeff@example.com"</span><span class="o">,</span> <span class="s">"jeffteenjefftyjeff"</span><span class="o">)</span>
  <span class="o">.</span><span class="na">withRequestBody</span><span class="o">(</span><span class="n">equalToXml</span><span class="o">(</span><span class="s">"&lt;search-results /&gt;"</span><span class="o">))</span>
  <span class="o">.</span><span class="na">withRequestBody</span><span class="o">(</span><span class="n">matchingXPath</span><span class="o">(</span><span class="s">"//search-results"</span><span class="o">))</span>
  <span class="o">.</span><span class="na">withMultipartRequestBody</span><span class="o">(</span>
  	<span class="n">aMultipart</span><span class="o">()</span>
  		<span class="o">.</span><span class="na">withName</span><span class="o">(</span><span class="s">"info"</span><span class="o">)</span>
  		<span class="o">.</span><span class="na">withHeader</span><span class="o">(</span><span class="s">"Content-Type"</span><span class="o">,</span> <span class="n">containing</span><span class="o">(</span><span class="s">"charset"</span><span class="o">))</span>
  		<span class="o">.</span><span class="na">withBody</span><span class="o">(</span><span class="n">equalToJson</span><span class="o">(</span><span class="s">"{}"</span><span class="o">))</span>
  <span class="o">)</span>
  <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">aResponse</span><span class="o">()));</span>
</code></pre></div></div>

<p>JSON:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"request"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"urlPath"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"/everything"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"method"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"ANY"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"headers"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"Accept"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"contains"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"xml"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"queryParameters"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"search_term"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"equalTo"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"WireMock"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"cookies"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"session"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"matches"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">".*12345.*"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"bodyPatterns"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"equalToXml"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;search-results /&gt;"</span><span class="w">
    </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"matchesXPath"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"//search-results"</span><span class="w">
    </span><span class="p">}</span><span class="w"> </span><span class="p">],</span><span class="w">
    </span><span class="nl">"multipartPatterns"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"matchingType"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"ANY"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"headers"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"Content-Disposition"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"contains"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"name=</span><span class="se">\"</span><span class="s2">info</span><span class="se">\"</span><span class="s2">"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"Content-Type"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"contains"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"charset"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nl">"bodyPatterns"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"equalToJson"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"{}"</span><span class="w">
      </span><span class="p">}</span><span class="w"> </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w"> </span><span class="p">],</span><span class="w">
    </span><span class="nl">"basicAuthCredentials"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"username"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"jeff@example.com"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"password"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"jeffteenjefftyjeff"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"response"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"status"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>The following sections describe each type of matching strategy in detail.</p>

<h2 id="url-matching">URL matching</h2>

<p>URLs can be matched either by equality or by regular expression. You also have a choice of whether to match just the path part of the URL or the path and query together.</p>

<p>It is usually preferable to match on path only if you want to match multiple query parameters in an order invariant manner.</p>

<h3 id="equality-matching-on-path-and-query">Equality matching on path and query</h3>

<p>Java:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">urlEqualTo</span><span class="o">(</span><span class="s">"/your/url?and=query"</span><span class="o">)</span>
</code></pre></div></div>

<p>JSON:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"request"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/your/url?and=query"</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h3 id="regex-matching-on-path-and-query">Regex matching on path and query</h3>

<p>Java:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">urlMatching</span><span class="o">(</span><span class="s">"/your/([a-z]*)\\?and=query"</span><span class="o">)</span>
</code></pre></div></div>

<p>JSON:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"request"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"urlPattern"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/your/([a-z]*)</span><span class="se">\\</span><span class="s2">?and=query"</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h3 id="equality-matching-on-the-path-only">Equality matching on the path only</h3>

<p>Java:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">urlPathEqualTo</span><span class="o">(</span><span class="s">"/your/url"</span><span class="o">)</span>
</code></pre></div></div>

<p>JSON:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"request"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"urlPath"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/your/url"</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h3 id="regex-matching-on-the-path-only">Regex matching on the path only</h3>

<p>Java:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">urlPathMatching</span><span class="o">(</span><span class="s">"/your/([a-z]*)"</span><span class="o">)</span>
</code></pre></div></div>

<p>JSON:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"request"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"urlPathPattern"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/your/([a-z]*)"</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h2 id="matching-other-attributes">Matching other attributes</h2>

<p>All request attributes other than the URL can be matched using the following set of operators.</p>

<h3 id="equality">Equality</h3>

<p>Deems a match if the entire attribute value equals the expected value.</p>

<p>Java:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">.</span><span class="na">withHeader</span><span class="o">(</span><span class="s">"Content-Type"</span><span class="o">,</span> <span class="n">equalTo</span><span class="o">(</span><span class="s">"application/json"</span><span class="o">))</span>
</code></pre></div></div>

<p>JSON:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"request"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="err">...</span><span class="w">
    </span><span class="nl">"headers"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"Content-Type"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"equalTo"</span><span class="p">:</span><span class="w"> </span><span class="s2">"application/json"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h3 id="case-insensitive-equality">Case-insensitive equality</h3>

<p>Deems a match if the entire attribute value equals the expected value, ignoring case.</p>

<p>Java:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">.</span><span class="na">withHeader</span><span class="o">(</span><span class="s">"Content-Type"</span><span class="o">,</span> <span class="n">equalToIgnoreCase</span><span class="o">(</span><span class="s">"application/json"</span><span class="o">))</span>
</code></pre></div></div>

<p>JSON:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"request"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="err">...</span><span class="w">
    </span><span class="nl">"headers"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"Content-Type"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"equalTo"</span><span class="p">:</span><span class="w"> </span><span class="s2">"application/json"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"caseInsensitive"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h3 id="binary-equality">Binary Equality</h3>

<p>Deems a match if the entire binary attribute value equals the expected value. Unlike the above equalTo operator, this compares byte arrays (or their equivalent base64 representation).</p>

<p>Java:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Specifying the expected value as a byte array</span>
<span class="o">.</span><span class="na">withRequestBody</span><span class="o">(</span><span class="n">binaryEqualTo</span><span class="o">(</span><span class="k">new</span> <span class="kt">byte</span><span class="o">[]</span> <span class="o">{</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span> <span class="o">}))</span>

<span class="c1">// Specifying the expected value as a base64 String</span>
<span class="o">.</span><span class="na">withRequestBody</span><span class="o">(</span><span class="n">binaryEqualTo</span><span class="o">(</span><span class="s">"AQID"</span><span class="o">))</span>
</code></pre></div></div>

<p>JSON:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"request"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="err">...</span><span class="w">
    </span><span class="nl">"bodyPatterns"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
        </span><span class="nl">"binaryEqualTo"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"AQID"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Base</span><span class="w"> </span><span class="mi">64</span><span class="w">
    </span><span class="p">}]</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h3 id="substring-contains">Substring (contains)</h3>

<p>Deems a match if the a portion of the attribute value equals the expected value.</p>

<p>Java:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">.</span><span class="na">withCookie</span><span class="o">(</span><span class="s">"my_profile"</span><span class="o">,</span> <span class="n">containing</span><span class="o">(</span><span class="s">"johnsmith@example.com"</span><span class="o">))</span>
</code></pre></div></div>

<p>JSON:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"request"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="err">...</span><span class="w">
    </span><span class="nl">"cookies"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"my_profile"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"contains"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"johnsmith@example.com"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h3 id="regular-expression">Regular expression</h3>

<p>Deems a match if the entire attribute value matched the expected regular expression.</p>

<p>Java:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">.</span><span class="na">withQueryParam</span><span class="o">(</span><span class="s">"search_term"</span><span class="o">,</span> <span class="n">matching</span><span class="o">(</span><span class="s">"^(.*)wiremock([A-Za-z]+)$"</span><span class="o">))</span>
</code></pre></div></div>

<p>JSON:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"request"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="err">...</span><span class="w">
    </span><span class="nl">"queryParameters"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"search_term"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"matches"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"^(.*)wiremock([A-Za-z]+)$"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>It is also possible to perform a negative match i.e. the match succeeds when the attribute value does not match the regex:</p>

<p>Java:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">.</span><span class="na">withQueryParam</span><span class="o">(</span><span class="s">"search_term"</span><span class="o">,</span> <span class="n">notMatching</span><span class="o">(</span><span class="s">"^(.*)wiremock([A-Za-z]+)$"</span><span class="o">))</span>
</code></pre></div></div>

<p>JSON:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"request"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="err">...</span><span class="w">
    </span><span class="nl">"queryParameters"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"search_term"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"doesNotMatch"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"^(.*)wiremock([A-Za-z]+)$"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h3 id="json-equality">JSON equality</h3>

<p>Deems a match if the attribute (most likely the request body in practice) is valid JSON and is a semantic match for the expected value.</p>

<p>Java:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">.</span><span class="na">withRequestBody</span><span class="o">(</span><span class="n">equalToJson</span><span class="o">(</span><span class="s">"{ \"total_results\": 4 }"</span><span class="o">))</span>
</code></pre></div></div>

<p>JSON:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"request"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="err">...</span><span class="w">
    </span><span class="nl">"bodyPatterns"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"equalToJson"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nl">"total_results"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w"> </span><span class="p">]</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>JSON with string literal:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"request"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="err">...</span><span class="w">
    </span><span class="nl">"bodyPatterns"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"equalToJson"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"{ </span><span class="se">\"</span><span class="s2">total_results</span><span class="se">\"</span><span class="s2">: 4 }"</span><span class="w">
    </span><span class="p">}</span><span class="w"> </span><span class="p">]</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h4 id="less-strict-matching">Less strict matching</h4>

<p>By default different array orderings and additional object attributes will trigger a non-match. However, both of these conditions can be disabled individually.</p>

<p>Java:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">.</span><span class="na">withRequestBody</span><span class="o">(</span><span class="n">equalToJson</span><span class="o">(</span><span class="s">"{ \"total_results\": 4  }"</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="kc">true</span><span class="o">))</span>
</code></pre></div></div>

<p>JSON:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"request"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="err">...</span><span class="w">
    </span><span class="nl">"bodyPatterns"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"equalToJson"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"{ </span><span class="se">\"</span><span class="s2">total_results</span><span class="se">\"</span><span class="s2">: 4  }"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"ignoreArrayOrder"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nl">"ignoreExtraElements"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
    </span><span class="p">}</span><span class="w"> </span><span class="p">]</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h4 id="placeholders">Placeholders</h4>

<p>JSON equality matching is based on <a href="https://github.com/lukas-krecan/JsonUnit">JsonUnit</a> and therefore supports placeholders.
This allows specific attributes to be treated as wildcards, rather than an exactly value being required for a match.</p>

<p>For instance, the following:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w"> </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"${json-unit.any-string}"</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>would match a request with a JSON body of:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w"> </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"abc123"</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>It’s also possible to use placeholders that constrain the expected value by type or regular expression.
See <a href="https://github.com/lukas-krecan/JsonUnit#typeplc">the JsonUnit placeholders documentation</a> for the full syntax.</p>

<blockquote>
  <p><strong>note</strong></p>

  <p>Placeholders are only available in the <code class="language-plaintext highlighter-rouge">jre8</code> WireMock JARs, as the JsonUnit library requires at least Java 8.</p>
</blockquote>

<h3 id="json-path">JSON Path</h3>

<p>Deems a match if the attribute value is valid JSON and matches the <a href="http://goessner.net/articles/JsonPath/">JSON Path</a> expression supplied. A JSON body will be considered to match a path expression if the expression returns either a non-null single value (string, integer etc.), or a non-empty object or array.</p>

<h4 id="presence-matching">Presence matching</h4>

<p>Deems a match if the attribute value is present in the JSON.</p>

<p>Java:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">.</span><span class="na">withRequestBody</span><span class="o">(</span><span class="n">matchingJsonPath</span><span class="o">(</span><span class="s">"$.name"</span><span class="o">))</span>
</code></pre></div></div>

<p>JSON:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"request"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="err">...</span><span class="w">
    </span><span class="nl">"bodyPatterns"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"matchesJsonPath"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"$.name"</span><span class="w">
    </span><span class="p">}</span><span class="w"> </span><span class="p">]</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Request body example:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// matching
{ "name": "Wiremock" }
// not matching
{ "price": 15 }
</code></pre></div></div>

<h4 id="equality-matching">Equality matching</h4>

<p>Deems a match if the attribute value equals the expected value.</p>

<p>Java:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">.</span><span class="na">withRequestBody</span><span class="o">(</span><span class="n">matchingJsonPath</span><span class="o">(</span><span class="s">"$.things[?(@.name == 'RequiredThing')]"</span><span class="o">))</span>
</code></pre></div></div>

<p>JSON:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"request"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="err">...</span><span class="w">
    </span><span class="nl">"bodyPatterns"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"matchesJsonPath"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"$.things[?(@.name == 'RequiredThing')]"</span><span class="w">
    </span><span class="p">}</span><span class="w"> </span><span class="p">]</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Request body example:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// matching
{ "things": { "name": "RequiredThing" } }
{ "things": [ { "name": "RequiredThing" }, { "name": "Wiremock" } ] }
// not matching
{ "price": 15 }
{ "things": { "name": "Wiremock" } }
</code></pre></div></div>

<h4 id="regex-matching">Regex matching</h4>

<p>Deems a match if the attribute value matches the regex expected value.</p>

<p>Java:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">.</span><span class="na">withRequestBody</span><span class="o">(</span><span class="n">matchingJsonPath</span><span class="o">(</span><span class="s">"$.things[?(@.name =~ /Required.*/i)]"</span><span class="o">))</span>
</code></pre></div></div>

<p>JSON:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"request"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="err">...</span><span class="w">
    </span><span class="nl">"bodyPatterns"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"matchesJsonPath"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"$.things[?(@.name =~ /Required.*/i)]"</span><span class="w">
    </span><span class="p">}</span><span class="w"> </span><span class="p">]</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Request body example:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// matching
{ "things": { "name": "RequiredThing" } }
{ "things": [ { "name": "Required" }, { "name": "Wiremock" } ] }
// not matching
{ "price": 15 }
{ "things": { "name": "Wiremock" } }
{ "things": [ { "name": "Thing" }, { "name": "Wiremock" } ] }
</code></pre></div></div>

<h4 id="size-matching">Size matching</h4>

<p>Deems a match if the attribute size matches the expected size.</p>

<p>Java:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">.</span><span class="na">withRequestBody</span><span class="o">(</span><span class="n">matchingJsonPath</span><span class="o">(</span><span class="s">"$[?(@.things.size() == 2)]"</span><span class="o">))</span>
</code></pre></div></div>

<p>JSON:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"request"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="err">...</span><span class="w">
    </span><span class="nl">"bodyPatterns"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"matchesJsonPath"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"$[?(@.things.size() == 2)]"</span><span class="w">
    </span><span class="p">}</span><span class="w"> </span><span class="p">]</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Request body example:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// matching
{ "things": [ { "name": "RequiredThing" }, { "name": "Wiremock" } ] }
// not matching
{ "things": [ { "name": "RequiredThing" } ] }
</code></pre></div></div>

<h4 id="nested-value-matching">Nested value matching</h4>

<p>The JSONPath matcher can be combined with another matcher, such that the value returned from the JSONPath query is evaluated against it:</p>

<p>Java:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">.</span><span class="na">withRequestBody</span><span class="o">(</span><span class="n">matchingJsonPath</span><span class="o">(</span><span class="s">"$..todoItem"</span><span class="o">,</span> <span class="n">containing</span><span class="o">(</span><span class="s">"wash"</span><span class="o">)))</span>
</code></pre></div></div>

<p>JSON:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"request"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="err">...</span><span class="w">
    </span><span class="nl">"bodyPatterns"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"matchesJsonPath"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
         </span><span class="nl">"expression"</span><span class="p">:</span><span class="w"> </span><span class="s2">"$..todoItem"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"contains"</span><span class="p">:</span><span class="w"> </span><span class="s2">"wash"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w"> </span><span class="p">]</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Since WireMock’s matching operators all work on strings, the value selected by the JSONPath expression will be coerced to a string before the match is evaluated. This true even if the returned value
is an object or array. A benefit of this is that this allows a sub-document to be selected using JSONPath, then matched using the <code class="language-plaintext highlighter-rouge">equalToJson</code> operator. E.g. for the following request body:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"outer"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"inner"</span><span class="p">:</span><span class="w"> </span><span class="mi">42</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>The following will match:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">.</span><span class="na">withRequestBody</span><span class="o">(</span><span class="n">matchingJsonPath</span><span class="o">(</span><span class="s">"$.outer"</span><span class="o">,</span> <span class="n">equalToJson</span><span class="o">(</span><span class="s">"{                \n"</span> <span class="o">+</span>
                                                         <span class="s">"   \"inner\": 42 \n"</span> <span class="o">+</span>
                                                         <span class="s">"}"</span><span class="o">)))</span>
</code></pre></div></div>

<p>JSON:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"request"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="err">...</span><span class="w">
    </span><span class="nl">"bodyPatterns"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"matchesJsonPath"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
         </span><span class="nl">"expression"</span><span class="p">:</span><span class="w"> </span><span class="s2">"$.outer"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"equalToJson"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{ </span><span class="se">\"</span><span class="s2">inner</span><span class="se">\"</span><span class="s2">: 42 }"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w"> </span><span class="p">]</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h3 id="xml-equality">XML equality</h3>

<p>Deems a match if the attribute value is valid XML and is semantically equal to the expected XML document. The underlying engine for determining XML equality is <a href="http://www.xmlunit.org/">XMLUnit</a>.</p>

<p>Java:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">.</span><span class="na">withRequestBody</span><span class="o">(</span><span class="n">equalToXml</span><span class="o">(</span><span class="s">"&lt;thing&gt;Hello&lt;/thing&gt;"</span><span class="o">))</span>
</code></pre></div></div>

<p>JSON:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"request"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="err">...</span><span class="w">
    </span><span class="nl">"bodyPatterns"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"equalToXml"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;thing&gt;Hello&lt;/thing&gt;"</span><span class="w">
    </span><span class="p">}</span><span class="w"> </span><span class="p">]</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h4 id="use-of-placeholders">Use of placeholders</h4>

<p>The XMLUnit <a href="https://github.com/xmlunit/user-guide/wiki/Placeholders">placeholders</a> feature is supported in WireMock. For example, when comparing the XML documents, you can ignore some text nodes.</p>

<p>Java:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">.</span><span class="na">withRequestBody</span><span class="o">(</span>
    <span class="n">equalToXml</span><span class="o">(</span><span class="s">"&lt;message&gt;&lt;id&gt;${xmlunit.ignore}&lt;/id&gt;&lt;content&gt;Hello&lt;/content&gt;&lt;/message&gt;"</span><span class="o">,</span> <span class="kc">true</span><span class="o">)</span>
<span class="o">)</span>
</code></pre></div></div>

<p>JSON:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"request"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="err">...</span><span class="w">
    </span><span class="nl">"bodyPatterns"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"equalToXml"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;message&gt;&lt;id&gt;${xmlunit.ignore}&lt;/id&gt;&lt;content&gt;Hello&lt;/content&gt;&lt;/message&gt;"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"enablePlaceholders"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
    </span><span class="p">}</span><span class="w"> </span><span class="p">]</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>When the actual request body is <code class="language-plaintext highlighter-rouge">&lt;message&gt;&lt;id&gt;123456&lt;/id&gt;&lt;content&gt;Hello&lt;/content&gt;&lt;/message&gt;</code>, it will be deemed a match.</p>

<p>If the default placeholder delimiters <code class="language-plaintext highlighter-rouge">${</code> and <code class="language-plaintext highlighter-rouge">}</code> can not be used, you can specify custom delimiters (using regular expressions). For example</p>

<p>Java:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">.</span><span class="na">withRequestBody</span><span class="o">(</span>
    <span class="n">equalToXml</span><span class="o">(</span><span class="s">"&lt;message&gt;&lt;id&gt;[[xmlunit.ignore]]&lt;/id&gt;&lt;content&gt;Hello&lt;/content&gt;&lt;/message&gt;"</span><span class="o">,</span>
               <span class="kc">true</span><span class="o">,</span>
               <span class="s">"\\[\\["</span><span class="o">,</span>
               <span class="s">"]]"</span>
    <span class="o">)</span>
<span class="o">)</span>
</code></pre></div></div>

<p>JSON:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"request"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="err">...</span><span class="w">
    </span><span class="nl">"bodyPatterns"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"equalToXml"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;message&gt;&lt;id&gt;[[xmlunit.ignore]]&lt;/id&gt;&lt;content&gt;Hello&lt;/content&gt;&lt;/message&gt;"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"enablePlaceholders"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nl">"placeholderOpeningDelimiterRegex"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"</span><span class="se">\\</span><span class="s2">[</span><span class="se">\\</span><span class="s2">["</span><span class="p">,</span><span class="w">
      </span><span class="nl">"placeholderClosingDelimiterRegex"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"]]"</span><span class="w">
    </span><span class="p">}</span><span class="w"> </span><span class="p">]</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h4 id="excluding-specific-types-of-comparison">Excluding specific types of comparison</h4>

<p>You can further tune how XML documents are compared for equality by disabling specific <a href="https://www.xmlunit.org/api/java/2.7.0/org/xmlunit/diff/ComparisonType.html">XMLUnit comparison types</a>.</p>

<p>Java:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">xmlunit</span><span class="o">.</span><span class="na">diff</span><span class="o">.</span><span class="na">ComparisonType</span><span class="o">.*;</span>

<span class="o">...</span>

<span class="o">.</span><span class="na">withRequestBody</span><span class="o">(</span><span class="n">equalToXml</span><span class="o">(</span><span class="s">"&lt;thing&gt;Hello&lt;/thing&gt;"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">exemptingComparisons</span><span class="o">(</span><span class="no">NAMESPACE_URI</span><span class="o">,</span> <span class="no">ELEMENT_TAG_NAME</span><span class="o">)</span>
<span class="o">)</span>
</code></pre></div></div>

<p>JSON:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"request"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="err">...</span><span class="w">
    </span><span class="nl">"bodyPatterns"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"equalToXml"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;thing&gt;Hello&lt;/thing&gt;"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"exemptedComparisons"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"NAMESPACE_URI"</span><span class="p">,</span><span class="w"> </span><span class="s2">"ELEMENT_TAG_NAME"</span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w"> </span><span class="p">]</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>The full list of comparison types used by default is as follows:</p>

<p><code class="language-plaintext highlighter-rouge">ELEMENT_TAG_NAME</code>
<code class="language-plaintext highlighter-rouge">SCHEMA_LOCATION</code>
<code class="language-plaintext highlighter-rouge">NO_NAMESPACE_SCHEMA_LOCATION</code>
<code class="language-plaintext highlighter-rouge">NODE_TYPE</code>
<code class="language-plaintext highlighter-rouge">NAMESPACE_URI</code>
<code class="language-plaintext highlighter-rouge">TEXT_VALUE</code>
<code class="language-plaintext highlighter-rouge">PROCESSING_INSTRUCTION_TARGET</code>
<code class="language-plaintext highlighter-rouge">PROCESSING_INSTRUCTION_DATA</code>
<code class="language-plaintext highlighter-rouge">ELEMENT_NUM_ATTRIBUTES</code>
<code class="language-plaintext highlighter-rouge">ATTR_VALUE</code>
<code class="language-plaintext highlighter-rouge">CHILD_NODELIST_LENGTH</code>
<code class="language-plaintext highlighter-rouge">CHILD_LOOKUP</code>
<code class="language-plaintext highlighter-rouge">ATTR_NAME_LOOKUP</code></p>

<h3 id="xpath">XPath</h3>

<p>Deems a match if the attribute value is valid XML and matches the XPath expression supplied. An XML document will be considered to match if any elements are returned by the XPath evaluation. WireMock delegates to Java’s in-built XPath engine (via XMLUnit), therefore up to (at least) Java 8 it supports XPath version 1.0.</p>

<p>Java:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">.</span><span class="na">withRequestBody</span><span class="o">(</span><span class="n">matchingXPath</span><span class="o">(</span><span class="s">"/todo-list[count(todo-item) = 3]"</span><span class="o">))</span>
</code></pre></div></div>

<p>JSON:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"request"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="err">...</span><span class="w">
    </span><span class="nl">"bodyPatterns"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"matchesXPath"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"/todo-list[count(todo-item) = 3]"</span><span class="w">
    </span><span class="p">}</span><span class="w"> </span><span class="p">]</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>The above example will select elements based on their local name if used with a namespaced XML document.</p>

<p>If you need to be able to select elements based on their namespace in addition to their name you can declare the prefix
to namespace URI mappings and use them in your XPath expression:</p>

<p>Java:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">.</span><span class="na">withRequestBody</span><span class="o">(</span><span class="n">matchingXPath</span><span class="o">(</span><span class="s">"/stuff:outer/more:inner[.=111]"</span><span class="o">)</span>
  <span class="o">.</span><span class="na">withXPathNamespace</span><span class="o">(</span><span class="s">"stuff"</span><span class="o">,</span> <span class="s">"http://stuff.example.com"</span><span class="o">)</span>
  <span class="o">.</span><span class="na">withXPathNamespace</span><span class="o">(</span><span class="s">"more"</span><span class="o">,</span> <span class="s">"http://more.example.com"</span><span class="o">))</span>
</code></pre></div></div>

<p>JSON:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"request"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="err">...</span><span class="w">
    </span><span class="nl">"bodyPatterns"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"matchesXPath"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"/stuff:outer/more:inner[.=111]"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"xPathNamespaces"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"stuff"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"http://stuff.example.com"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"more"</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="s2">"http://more.example.com"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w"> </span><span class="p">]</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h4 id="nested-value-matching-1">Nested value matching</h4>

<p>The XPath matcher described above can be combined with another matcher, such that the value returned from the XPath query is evaluated against it:</p>

<p>Java:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">.</span><span class="na">withRequestBody</span><span class="o">(</span><span class="n">matchingXPath</span><span class="o">(</span><span class="s">"//todo-item/text()"</span><span class="o">,</span> <span class="n">containing</span><span class="o">(</span><span class="s">"wash"</span><span class="o">)))</span>
</code></pre></div></div>

<p>JSON:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"request"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="err">...</span><span class="w">
    </span><span class="nl">"bodyPatterns"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"matchesXPath"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
         </span><span class="nl">"expression"</span><span class="p">:</span><span class="w"> </span><span class="s2">"//todo-item/text()"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"contains"</span><span class="p">:</span><span class="w"> </span><span class="s2">"wash"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w"> </span><span class="p">]</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>If multiple nodes are returned from the XPath query, all will be evaluated and the returned match will be the one with the shortest distance.</p>

<p>If the XPath expression returns an XML element rather than a value, this will be rendered as an XML string before it is passed to the value matcher.
This can be usefully combined with the <code class="language-plaintext highlighter-rouge">equalToXml</code> matcher e.g.</p>

<p>Java:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">.</span><span class="na">withRequestBody</span><span class="o">(</span><span class="n">matchingXPath</span><span class="o">(</span><span class="s">"//todo-item"</span><span class="o">,</span> <span class="n">equalToXml</span><span class="o">(</span><span class="s">"&lt;todo-item&gt;Do the washing&lt;/todo-item&gt;"</span><span class="o">)))</span>
</code></pre></div></div>

<p>JSON:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"request"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="err">...</span><span class="w">
    </span><span class="nl">"bodyPatterns"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"matchesXPath"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
         </span><span class="nl">"expression"</span><span class="p">:</span><span class="w"> </span><span class="s2">"//todo-item"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"equalToXml"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;todo-item&gt;Do the washing&lt;/todo-item&gt;"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w"> </span><span class="p">]</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h3 id="absence">Absence</h3>

<p>Deems a match if the attribute specified is absent from the request.</p>

<p>Java:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">.</span><span class="na">withCookie</span><span class="o">(</span><span class="s">"session"</span><span class="o">,</span> <span class="n">absent</span><span class="o">())</span>
<span class="o">.</span><span class="na">withQueryParam</span><span class="o">(</span><span class="s">"search_term"</span><span class="o">,</span> <span class="n">absent</span><span class="o">())</span>
<span class="o">.</span><span class="na">withHeader</span><span class="o">(</span><span class="s">"X-Absent"</span><span class="o">,</span> <span class="n">absent</span><span class="o">())</span>
</code></pre></div></div>

<p>JSON:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"request"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="err">...</span><span class="w">
    </span><span class="nl">"headers"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"X-Absent"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"absent"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"queryParameters"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"search_term"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"absent"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"cookies"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"session"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"absent"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h2 id="multipartform-data">Multipart/form-data</h2>

<p>Deems a match if a multipart value is valid and matches any or all the multipart pattern matchers supplied.   As a Multipart is a ‘mini’ HTTP request in itself all existing Header and Body content matchers can by applied to a Multipart pattern.
A Multipart pattern can be defined as matching <code class="language-plaintext highlighter-rouge">ANY</code> request multiparts or <code class="language-plaintext highlighter-rouge">ALL</code>. The default matching type is <code class="language-plaintext highlighter-rouge">ANY</code>.</p>

<p>Java:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">stubFor</span><span class="o">(...)</span>
  <span class="o">...</span>
  <span class="o">.</span><span class="na">withMultipartRequestBody</span><span class="o">(</span>
  	<span class="n">aMultipart</span><span class="o">()</span>
  		<span class="o">.</span><span class="na">withName</span><span class="o">(</span><span class="s">"info"</span><span class="o">)</span>
  		<span class="o">.</span><span class="na">withHeader</span><span class="o">(</span><span class="s">"Content-Type"</span><span class="o">,</span> <span class="n">containing</span><span class="o">(</span><span class="s">"charset"</span><span class="o">))</span>
  		<span class="o">.</span><span class="na">withMultipartBody</span><span class="o">(</span><span class="n">equalToJson</span><span class="o">(</span><span class="s">"{}"</span><span class="o">))</span>
  <span class="o">)</span>
</code></pre></div></div>

<p>JSON:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"request"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="err">...</span><span class="w">
    </span><span class="nl">"multipartPatterns"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"matchingType"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"ANY"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"headers"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"Content-Disposition"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"contains"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"name=</span><span class="se">\"</span><span class="s2">info</span><span class="se">\"</span><span class="s2">"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"Content-Type"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"contains"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"charset"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nl">"bodyPatterns"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"equalToJson"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"{}"</span><span class="w">
      </span><span class="p">}</span><span class="w"> </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w"> </span><span class="p">],</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h2 id="basic-authentication">Basic Authentication</h2>

<p>Although matching on HTTP basic authentication could be supported via a
correctly encoded <code class="language-plaintext highlighter-rouge">Authorization</code> header, you can also do this more simply
via the API.</p>

<p>Java:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">stubFor</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="n">urlEqualTo</span><span class="o">(</span><span class="s">"/basic-auth"</span><span class="o">)).</span><span class="na">withBasicAuth</span><span class="o">(</span><span class="s">"user"</span><span class="o">,</span> <span class="s">"pass"</span><span class="o">)</span>
</code></pre></div></div>

<p>JSON:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"request"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GET"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/basic-auth"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"basicAuth"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"username"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"user"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"password"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"pass"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"response"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h2 id="dates-and-times">Dates and times</h2>

<p>Dates and times can be matched in several ways. Three comparison operators are available: <code class="language-plaintext highlighter-rouge">before</code>, <code class="language-plaintext highlighter-rouge">after</code> and
<code class="language-plaintext highlighter-rouge">equalToDateTime</code>, all of which have the same set of parameters.</p>

<p>Additionally, the expected value can be either literal (fixed) or an offset from the current date. Both the expected and
actual dates can be truncated in various ways.</p>

<h3 id="literal-datetimes">Literal date/times</h3>

<p>You can match an incoming date/time against a fixed value e.g. “match if the X-Munged-Date request header is after x”:</p>

<p>Java:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">stubFor</span><span class="o">(</span><span class="n">post</span><span class="o">(</span><span class="s">"/dates"</span><span class="o">)</span>
  <span class="o">.</span><span class="na">withHeader</span><span class="o">(</span><span class="s">"X-Munged-Date"</span><span class="o">,</span> <span class="n">after</span><span class="o">(</span><span class="s">"2021-05-01T00:00:00Z"</span><span class="o">))</span>
  <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">ok</span><span class="o">()));</span>

<span class="c1">// You can also use a ZonedDateTime or LocalDateTime object</span>
<span class="n">stubFor</span><span class="o">(</span><span class="n">post</span><span class="o">(</span><span class="s">"/dates"</span><span class="o">)</span>
  <span class="o">.</span><span class="na">withHeader</span><span class="o">(</span><span class="s">"X-Munged-Date"</span><span class="o">,</span> <span class="n">after</span><span class="o">(</span><span class="nc">ZonedDateTime</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="s">"2021-05-01T00:00:00Z"</span><span class="o">)))</span>
  <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">ok</span><span class="o">()));</span>
</code></pre></div></div>

<p>JSON:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"request"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"url"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"/dates"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"method"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"POST"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"headers"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"X-Munged-Date"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"after"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"2021-05-01T00:00:00Z"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"response"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"status"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h3 id="offset">Offset</h3>

<p>You can also match in incoming value against the current date/time or an offset from it:</p>

<p>Java:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">stubFor</span><span class="o">(</span><span class="n">post</span><span class="o">(</span><span class="s">"/dates"</span><span class="o">)</span>
  <span class="o">.</span><span class="na">withHeader</span><span class="o">(</span><span class="s">"X-Munged-Date"</span><span class="o">,</span> <span class="n">beforeNow</span><span class="o">().</span><span class="na">expectedOffset</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="nc">DateTimeUnit</span><span class="o">.</span><span class="na">DAYS</span><span class="o">))</span> 
  <span class="o">.</span><span class="na">withHeader</span><span class="o">(</span><span class="s">"X-Finalised-Date"</span><span class="o">,</span> <span class="n">before</span><span class="o">(</span><span class="s">"now +2 months"</span><span class="o">))</span> <span class="c1">// This form and beforeNow() are equivalent</span>
  <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">ok</span><span class="o">()));</span>
</code></pre></div></div>

<p>JSON:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"request"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"url"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"/dates"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"method"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"POST"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"headers"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"X-Munged-Date"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"before"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"now +3 days"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nl">"X-Finalised-Date"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="err">//</span><span class="w"> </span><span class="err">This</span><span class="w"> </span><span class="err">is</span><span class="w"> </span><span class="err">equivalent</span><span class="w"> </span><span class="err">to</span><span class="w"> </span><span class="s2">"now +2 months"</span><span class="w">
        </span><span class="nl">"before"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"now"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"expectedOffset"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
        </span><span class="nl">"expectedOffsetUnit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"months"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h3 id="local-vs-zoned">Local vs. Zoned</h3>

<p>Both the expected and actual date/time values can either have timezone information or not. For instance a
date in ISO8601 format could be zoned: <code class="language-plaintext highlighter-rouge">2021-06-24T13:40:27+01:00</code> or <code class="language-plaintext highlighter-rouge">2021-06-24T12:40:27Z</code>, or local: <code class="language-plaintext highlighter-rouge">2021-06-24T12:40:27</code>.</p>

<p>Likewise a date/time in RFC 1123 (HTTP standard) format is also zoned: <code class="language-plaintext highlighter-rouge">Tue, 01 Jun 2021 15:16:17 GMT</code>.</p>

<p>Whether the expected and actual values are zoned or not affects whether they can be matched and how. Generally, the best
approach is to try to ensure you’re using the same on both sides - if you’re expected a zoned actual date, then use one
as the expected date also, plus the equivalent for local dates.</p>

<p>If the expected date is zoned and the actual is local, the actual date will assume the system timezone before the
comparison is attempted.</p>

<p>If the expected date is local and the actual is zoned, the timezone will be stripped from the actual value before the
comparison is attempted.</p>

<h3 id="date-formats">Date formats</h3>

<p>By default these matchers will attempt to parse date/times in ISO8601 format, plus the three standard formats defined by
HTTP RFCs 1123, 1036 and asctime (taken from C but also valid for specifying HTTP dates).</p>

<p>It is also possible to specify your own format using
<a href="https://docs.oracle.com/javase/8/docs/api/java/time/format/DateTimeFormatter.html#patterns">Java’s date format strings</a>.</p>

<p>Java:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">stubFor</span><span class="o">(</span><span class="n">post</span><span class="o">(</span><span class="s">"/dates"</span><span class="o">)</span>
  <span class="o">.</span><span class="na">withHeader</span><span class="o">(</span><span class="s">"X-Munged-Date"</span><span class="o">,</span>
    <span class="n">equalToDateTime</span><span class="o">(</span><span class="s">"2021-06-24T00:00:00"</span><span class="o">).</span><span class="na">actualFormat</span><span class="o">(</span><span class="s">"dd/MM/yyyy"</span><span class="o">))</span>
  <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">ok</span><span class="o">()));</span>
</code></pre></div></div>

<p>JSON:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"request"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"url"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"/dates"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"method"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"POST"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"headers"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"X-Munged-Date"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"equalToDateTime"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"2021-06-24T00:00:00"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"actualFormat"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"dd/MM/yyyy"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h3 id="truncation">Truncation</h3>

<p>Both the expected and actual date/times can be truncated in various ways e.g. to the first hour of the day. When using
offset from now as the expected date with truncation, the truncation will be applied first followed by the offsetting.</p>

<p>Truncation is useful if you want to create expressions like “before the end of this month” or “equal to the current hour”.</p>

<p>It can usefully be combined with offsetting so e.g. if the match required is “after the 15th of this month” we could do
as follows.</p>

<p>Java:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">stubFor</span><span class="o">(</span><span class="n">post</span><span class="o">(</span><span class="s">"/dates"</span><span class="o">)</span>
  <span class="o">.</span><span class="na">withRequestBody</span><span class="o">(</span><span class="n">matchingJsonPath</span><span class="o">(</span>
      <span class="s">"$.completedDate"</span><span class="o">,</span>
      <span class="n">after</span><span class="o">(</span><span class="s">"now +15 days"</span><span class="o">).</span><span class="na">truncateExpected</span><span class="o">(</span><span class="no">FIRST_DAY_OF_MONTH</span><span class="o">))</span>
  <span class="o">)</span>
  <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">ok</span><span class="o">()));</span>
</code></pre></div></div>

<p>JSON:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"request"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"url"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"/dates"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"method"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"POST"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"bodyPatterns"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
      </span><span class="nl">"matchesJsonPath"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"expression"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"$.completedDate"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"after"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"now +15 days"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"truncateExpected"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"first day of month"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Truncating the actual value can be useful when checking for equality with literal date/times e.g. to say “is in March 2020”:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">stubFor</span><span class="o">(</span><span class="n">post</span><span class="o">(</span><span class="s">"/dates"</span><span class="o">)</span>
  <span class="o">.</span><span class="na">withRequestBody</span><span class="o">(</span><span class="n">matchingJsonPath</span><span class="o">(</span>
    <span class="s">"$.completedDate"</span><span class="o">,</span>
    <span class="n">equalToDateTime</span><span class="o">(</span><span class="s">"2020-03-01T00:00:00Z"</span><span class="o">).</span><span class="na">truncateActual</span><span class="o">(</span><span class="no">FIRST_DAY_OF_MONTH</span><span class="o">))</span>
  <span class="o">)</span>
  <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">ok</span><span class="o">()));</span>
</code></pre></div></div>

<p>JSON:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"request"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"url"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"/dates"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"method"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"POST"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"bodyPatterns"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
      </span><span class="nl">"matchesJsonPath"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"expression"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"$.completedDate"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"equalToDateTime"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-03-01T00:00:00Z"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"truncateActual"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"first day of month"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<div id="all-truncations"></div>
<p>The full list of available truncations is:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">first minute of hour</code></li>
  <li><code class="language-plaintext highlighter-rouge">first hour of day</code></li>
  <li><code class="language-plaintext highlighter-rouge">first day of month</code></li>
  <li><code class="language-plaintext highlighter-rouge">first day of next month</code></li>
  <li><code class="language-plaintext highlighter-rouge">last day of month</code></li>
  <li><code class="language-plaintext highlighter-rouge">first day of year</code></li>
  <li><code class="language-plaintext highlighter-rouge">first day of next year</code></li>
  <li><code class="language-plaintext highlighter-rouge">last day of year</code></li>
</ul>

<h2 id="logical-and-and-or">Logical AND and OR</h2>

<p>You can combine two or more matchers in an AND expression.</p>

<p>Java:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Both statements are equivalent</span>

<span class="n">stubFor</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="n">urlPathEqualTo</span><span class="o">(</span><span class="s">"/and"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">withHeader</span><span class="o">(</span><span class="s">"X-Some-Value"</span><span class="o">,</span> <span class="n">and</span><span class="o">(</span>
        <span class="n">matching</span><span class="o">(</span><span class="s">"[a-z]+"</span><span class="o">),</span>
        <span class="n">containing</span><span class="o">(</span><span class="s">"magicvalue"</span><span class="o">))</span>
    <span class="o">)</span>
    <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">ok</span><span class="o">()));</span>

<span class="n">stubFor</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="n">urlPathEqualTo</span><span class="o">(</span><span class="s">"/and"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">withHeader</span><span class="o">(</span><span class="s">"X-Some-Value"</span><span class="o">,</span> <span class="n">matching</span><span class="o">(</span><span class="s">"[a-z]+"</span><span class="o">).</span><span class="na">and</span><span class="o">(</span><span class="n">containing</span><span class="o">(</span><span class="s">"magicvalue"</span><span class="o">)))</span>
    <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">ok</span><span class="o">()));</span>
</code></pre></div></div>

<p>JSON:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"request"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"urlPath"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/and"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GET"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"headers"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"X-Some-Value"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"and"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nl">"matches"</span><span class="p">:</span><span class="w"> </span><span class="s2">"[a-z]+"</span><span class="w">
          </span><span class="p">},</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nl">"contains"</span><span class="p">:</span><span class="w"> </span><span class="s2">"magicvalue"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Similarly you can also construct an OR expression.</p>

<p>Java:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Both statements are equivalent</span>

<span class="n">stubFor</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="n">urlPathEqualTo</span><span class="o">(</span><span class="s">"/or"</span><span class="o">))</span>
  <span class="o">.</span><span class="na">withQueryParam</span><span class="o">(</span><span class="s">"search"</span><span class="o">,</span> <span class="n">or</span><span class="o">(</span>
        <span class="n">matching</span><span class="o">(</span><span class="s">"[a-z]+"</span><span class="o">),</span>
        <span class="n">absent</span><span class="o">())</span>
  <span class="o">)</span>
  <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">ok</span><span class="o">()));</span>

<span class="n">stubFor</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="n">urlPathEqualTo</span><span class="o">(</span><span class="s">"/or"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">withQueryParam</span><span class="o">(</span><span class="s">"search"</span><span class="o">,</span> <span class="n">matching</span><span class="o">(</span><span class="s">"[a-z]+"</span><span class="o">).</span><span class="na">or</span><span class="o">(</span><span class="n">absent</span><span class="o">()))</span>
    <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">ok</span><span class="o">()));</span>
</code></pre></div></div>

<p>JSON:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"request"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"urlPath"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"/or"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"method"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"GET"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"queryParameters"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"search"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"or"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"matches"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"[a-z]+"</span><span class="w">
        </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"absent"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
        </span><span class="p">}</span><span class="w"> </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h3 id="combining-date-matchers-as-jsonpathxpath-sub-matchers">Combining date matchers as JSONPath/XPath sub-matchers</h3>

<p>As an example of how various matchers can be combined, suppose we want to match if a field named <code class="language-plaintext highlighter-rouge">date</code> in a JSON request body
is a date/time between two points.</p>

<p>We can do this by extracting the field using <code class="language-plaintext highlighter-rouge">matchesJsonPath</code> then matching the result
of this against the <code class="language-plaintext highlighter-rouge">before</code> and <code class="language-plaintext highlighter-rouge">after</code> matchers AND’d together.</p>

<p>Java:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">stubFor</span><span class="o">(</span><span class="n">post</span><span class="o">(</span><span class="s">"/date-range"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">withRequestBody</span><span class="o">(</span><span class="n">matchingJsonPath</span><span class="o">(</span><span class="s">"$.date"</span><span class="o">,</span>
        <span class="n">before</span><span class="o">(</span><span class="s">"2022-01-01T00:00:00"</span><span class="o">).</span><span class="na">and</span><span class="o">(</span>
        <span class="n">after</span><span class="o">(</span><span class="s">"2020-01-01T00:00:00"</span><span class="o">))))</span>
    <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">ok</span><span class="o">()));</span>
</code></pre></div></div>

<p>JSON:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"request"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"url"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"/date-range"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"method"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"POST"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"bodyPatterns"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"matchesJsonPath"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"expression"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"$.date"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"and"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"before"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"2022-01-01T00:00:00"</span><span class="w">
        </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"after"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-01-01T00:00:00"</span><span class="w">
        </span><span class="p">}</span><span class="w"> </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w"> </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>This would match the following JSON request body:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2021-01-01T00:00:00"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

        
      </section>

      <footer class="page__meta">
        
        




      </footer>

      
    </div>

    
  </article>

  
  
</div>


    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        

<div class="page__footer-follow">
  <ul class="social-icons">
    
    <li><strong>Follow:</strong></li>
    
    
    
    
    
    <li><a href="/feed.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>


<div class="webinarFooterBanner">
  <div class="webinarFooterLeftBlock">
      <img src="/images/sponsoredByUP9.svg" alt="sponsored by up9" />
  </div>
  <div class="wrapperWebinarFT">
      <div class="webinarBannerLecturer">
          <img class="refael" src="/images/refael.png" alt="refael" />
          <img class="tom" src="/images/TomAkehurst.png" alt="tom" />
      </div>
      <div class="counterDownWrapper">
          <h4 class="upcomingWebinarTXT">
              UPCOMING WEBINAR
          </h4>
          <span class="webinarDescriptionTXT">
              Demonstrating our new
              <img
                  class="kubernetesFooterBannerIMG"
                  src="/images/kubernetesFooterBanner.png"
                  alt="kubernetes"
              />
              capabilities.
          </span>
      </div>
      <div class="webinarCountDownWrapper">
          <div class="countDownBlock">
              <h4 class="days"></h4>
              <span>Days</span>
          </div>
          <div class="countDownBlock">
              <h4 class="hours"></h4>
              <span>Hours</span>
          </div>
          <div class="countDownBlock">
              <h4 class="minutes"></h4>
              <span>Minutes</span>
          </div>
          <div class="countDownBlock">
              <h4 class="seconds"></h4>
              <span>Seconds</span>
          </div>
      </div>

      <button
          id="footerWebinarRegister"
          class="deffaultBTN webinarBannerRegisterBTN"
      >
          REGISTER NOW
      </button>
  </div>
  <div class="webinarFooterRightBlock">
      <img
          id="closeWebinarFooterBannerIMG"
          class="closeWebinarFooterBannerIMG"
          src="/images/closeBTNwebinarFooterBanner.svg"
          alt="close footer webinar banner"
      />
  </div>
</div>

<div class="page__footer-copyright">&copy; 2022 Tom Akehurst. Powered by <a href="http://jekyllrb.com"
                                                                                                                                                                  rel="nofollow">Jekyll</a> &amp; <a
  href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.
</div>

<div id="dialog" style="display: none">
  <h2 class="mocklab-popup__title">Looking for super-quick hosted mocks? Try MockLab</h2>
  <p>Instant mock services on your own public URL, zero code required. Paste, record and generate mock data. Tester-friendly UI.</p>
</div>

<script src="../assets/js/countdownClock.js"></script>

<script type="text/javascript">
  

  function setNotificationSeenCookie() {
    var expiresDate = new Date();
    expiresDate.setTime(expiresDate.getTime() + (30 * 86400000));
    document.cookie = "mocklab_notification_seen=true;expires=" + expiresDate.toGMTString() + ";path=/";
  }

  function setFooterWebinarBannerCookie() {
    document.cookie = "mocklab_footerWebinar_seen=true;path=/";
  }

  function sendNavigatedToMockLabEvent(location) {
    ga('send', 'event', location, 'navigated_to_mocklab', 'Navigated to MockLab', 1);
  }

  window.onload = function () {
    $("a[title='MockLab']").click(function() {
      ga('send', 'event', 'primary_nav', 'mocklab_clicked', 'MockLab clicked', 1);
      sendNavigatedToMockLabEvent('primary_nav');
    });

    $("a[title='Consulting Services']").click(function() {
      ga('send', 'event', 'primary_nav', 'consulting_services_clicked', 'Consulting Services clicked', 1);
    });

    if (!document.cookie.includes('mocklab_footerWebinar_seen')) {

      document.getElementById("footerWebinarRegister").addEventListener("click", registerToWebinar);
      document.getElementById('closeWebinarFooterBannerIMG').addEventListener("click", closeFooterWebinar);
      const webinarFooterBanner = document.getElementsByClassName('webinarFooterBanner');

      webinarFooterBanner[0].classList.add('displayFooterWebinarBanner');

      function registerToWebinar() {
        setFooterWebinarBannerCookie()
        webinarFooterBanner[0].classList.add('hideFooterWebinarBanner');
        window.location.href = "https://bit.ly/3fv1SOs";
      }

      function closeFooterWebinar() {
        setFooterWebinarBannerCookie()
        webinarFooterBanner[0].classList.add('hideFooterWebinarBanner');
      }

      window.setTimeout(function () {
        countDownClock();
      })
    }

    if (!document.cookie.includes('mocklab_notification_seen') && !window.suppressMockLabPopover) {
      window.setTimeout(function () {
        $("#dialog").dialog({
          dialogClass: 'mocklab-popup',
          draggable: false,
          resizable: false,
          modal: true,
          show: {
            effect: 'fade',
            duration: 1000
          },
          buttons: [{
            class: 'mocklab-popup__confirm-button',
            text: "Learn More",
            click: function () {
              ga('send', 'event', 'mocklab_popup', 'learn_more_clicked', 'Learn More clicked', 1);
              sendNavigatedToMockLabEvent();
              window.location.href = "http://get.mocklab.io/?utm_source=wiremock.org&utm_medium=mocklab-popup&utm_campaign=mocklab"
            }
          }]
        });

        setNotificationSeenCookie();
        ga('send', 'event', 'mocklab_popup', 'mocklab_popup_seen', 'MockLab popup seen', 0);
      }, 500);

    }

    $("#mocklab-callout-learn-more").click(function() {
      ga('send', 'event', 'mocklab_homepage_section', 'learn_more_clicked', 'Learn More clicked', 1);
      sendNavigatedToMockLabEvent('mocklab_homepage_section');
    });

    $("#mocklab-callout-try-it-now").click(function() {
      ga('send', 'event', 'mocklab_homepage_section', 'try_it_now_clicked', 'Try It Now clicked', 2);
      sendNavigatedToMockLabEvent('mocklab_homepage_section');
    });
  };
</script>

      </footer>
    </div>

    <script src="/assets/js/main.min.js"></script>




  </body>
</html>

